/* Granada v2 - Main Stylesheet
   Pixel-perfect replica of turath.io dark theme
   ============================================= */

/* CSS Custom Properties (Design Tokens) */
:root {
  /* Background Colors */
  --bg-color: #242426;
  --bg-card: #2d2d30;
  --bg-input: #2d2d30;
  --bg-hover: #3a3a3d;

  /* Text Colors */
  --text-primary: #d0d0d0;
  --text-secondary: #888;
  --text-muted: #666;

  /* UI Colors */
  --border-color: #555;
  --accent: #5294c4;
  --accent-light: #bbd6e7;
  --danger: #e57373;
  --success: #81c784;

  /* Shadows */
  --shadow-popover: 0 0 10px rgba(0, 0, 0, 0.5);

  /* Spacing */
  --spacing-xs: 4px;
  --spacing-sm: 8px;
  --spacing-md: 16px;
  --spacing-lg: 24px;
  --spacing-xl: 32px;

  /* Border Radius */
  --radius-sm: 4px;
  --radius-md: 5px;
  --radius-lg: 8px;

  /* Navigation Height */
  --nav-height: 70px;

  /* Layout Dimensions */
  --sidebar-width: 320px;
  --progress-bar-height: 50px;
  --content-padding: 24px;
}

/* Light Theme (for future toggle) */
[data-theme="light"] {
  --bg-color: #f5f5f5;
  --bg-card: #ffffff;
  --bg-input: #ffffff;
  --bg-hover: #eeeeee;
  --text-primary: #333333;
  --text-secondary: #666666;
  --text-muted: #999999;
  --border-color: #dddddd;
}

/* Reset & Base Styles */
*, *::before, *::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html {
  font-family: 'Kitab', 'Noto Naskh Arabic', 'Amiri', system-ui, sans-serif;
  font-size: 18px;
  line-height: 1.75;
  direction: rtl;
  scroll-behavior: smooth;
}

@media (min-width: 576px) {
  html { font-size: 19px; }
}

@media (min-width: 768px) {
  html { font-size: 21px; }
}

@media (min-width: 992px) {
  html { font-size: 22px; }
}

body {
  background-color: var(--bg-color);
  color: var(--text-primary);
  min-height: 100vh;
  padding-bottom: var(--nav-height); /* Space for mobile nav */
}

@media (min-width: 768px) {
  body {
    padding-bottom: 0;
    padding-top: var(--nav-height); /* Space for top nav */
  }
}

/* Typography */
h1, h2, h3, h4, h5, h6 {
  font-weight: normal;
  line-height: 1.4;
}

h1 { font-size: 1.5rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; }

a {
  color: var(--accent);
  text-decoration: none;
}

a:hover {
  color: var(--accent-light);
}

/* Utility Classes */
.text-secondary { color: var(--text-secondary); }
.text-muted { color: var(--text-muted); }
.text-danger { color: var(--danger); }
.text-success { color: var(--success); }
.text-accent { color: var(--accent); }

.hidden { display: none !important; }
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  border: 0;
}

/* Layout */
.container {
  max-width: 800px;
  margin: 0 auto;
  padding: 0 var(--spacing-md);
}

.page-content {
  padding: var(--spacing-lg) 0;
}

/* Navigation */
nav {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background: var(--bg-color);
  border-top: 1px solid var(--border-color);
  padding: 6px 0;
  z-index: 1000;
}

@media (min-width: 768px) {
  nav {
    top: 0;
    bottom: auto;
    border-top: none;
    border-bottom: 1px solid var(--border-color);
  }
}

.nav-items {
  display: flex;
  justify-content: space-around;
  align-items: center;
  max-width: 600px;
  margin: 0 auto;
  padding: 0 var(--spacing-md);
}

.nav-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
  color: var(--text-secondary);
  font-size: 0.65rem;
  padding: var(--spacing-xs);
  transition: color 0.2s;
}

.nav-item:hover,
.nav-item.active {
  color: var(--accent);
}

.nav-item svg {
  width: 22px;
  height: 22px;
}

/* Search Input Container */
.search-input-cont {
  background: var(--bg-card);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  width: min(85vw, 20rem);
  margin: 0 auto;
  display: flex;
  align-items: center;
  padding: var(--spacing-sm) var(--spacing-md);
  font-size: 0.9rem;
}

.search-input-cont input {
  flex: 1;
  background: transparent;
  border: none;
  color: var(--text-primary);
  font-family: inherit;
  font-size: inherit;
  outline: none;
}

.search-input-cont input::placeholder {
  color: var(--text-muted);
}

.search-icons {
  display: flex;
  gap: var(--spacing-xs);
}

.search-icon-btn {
  background: transparent;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  padding: var(--spacing-xs);
  border-radius: var(--radius-sm);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: color 0.2s, background-color 0.2s;
}

.search-icon-btn:hover {
  color: var(--text-primary);
  background: var(--bg-hover);
}

.search-icon-btn svg {
  width: 18px;
  height: 18px;
}

/* Popover (Dropdowns) */
.popover {
  position: absolute;
  background: var(--bg-card);
  border-radius: var(--radius-sm);
  padding: var(--spacing-xs);
  font-size: 0.85rem;
  box-shadow: var(--shadow-popover);
  width: 250px;
  max-height: 70vh;
  overflow-y: auto;
  z-index: 1001;
}

.popover-header {
  padding: var(--spacing-sm) var(--spacing-md);
  border-bottom: 1px solid var(--border-color);
  font-weight: 500;
}

.popover-section {
  border-bottom: 1px solid var(--border-color);
}

.popover-section:last-child {
  border-bottom: none;
}

.popover-section-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--spacing-sm) var(--spacing-md);
  cursor: pointer;
  transition: background-color 0.2s;
}

.popover-section-header:hover {
  background: var(--bg-hover);
}

.popover-section-title {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
}

.popover-section-count {
  color: var(--text-muted);
  font-size: 0.8rem;
}

.popover-section-content {
  padding: var(--spacing-sm) var(--spacing-md);
  display: none;
}

.popover-section.expanded .popover-section-content {
  display: block;
}

.popover-search {
  width: 100%;
  background: var(--bg-input);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  padding: var(--spacing-xs) var(--spacing-sm);
  color: var(--text-primary);
  font-family: inherit;
  font-size: 0.85rem;
  margin-bottom: var(--spacing-sm);
}

.popover-search:focus {
  outline: none;
  border-color: var(--accent);
}

.popover-checkbox-list {
  max-height: 200px;
  overflow-y: auto;
}

.popover-checkbox-item {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  padding: var(--spacing-xs) 0;
  cursor: pointer;
}

.popover-checkbox-item:hover {
  color: var(--accent-light);
}

.popover-checkbox-item input[type="checkbox"] {
  accent-color: var(--accent);
}

/* Filter Tags */
.filter-tags {
  display: flex;
  flex-wrap: wrap;
  gap: var(--spacing-sm);
  justify-content: center;
  margin-top: var(--spacing-md);
}

.filter-tag {
  background: linear-gradient(#38383b, #2f2f32 90%);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-md);
  padding: 2px var(--spacing-sm);
  font-size: 0.75rem;
  display: flex;
  align-items: center;
  gap: var(--spacing-xs);
  cursor: pointer;
}

.filter-tag-remove {
  color: var(--text-muted);
  font-size: 0.9rem;
  line-height: 1;
}

.filter-tag-remove:hover {
  color: var(--danger);
}

.filter-tag-dropdown {
  color: var(--text-muted);
  font-size: 0.7rem;
}

/* Search Results */
.results-count {
  text-align: center;
  color: var(--text-secondary);
  font-size: 0.85rem;
  margin: var(--spacing-md) 0;
}

.search-results {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-md);
}

.result-item {
  background: var(--bg-card);
  border-radius: var(--radius-sm);
  padding: var(--spacing-md);
  cursor: pointer;
  transition: background-color 0.2s;
}

.result-item:hover {
  background: var(--bg-hover);
}

.result-title {
  font-size: 1rem;
  margin-bottom: var(--spacing-xs);
}

.result-meta {
  color: var(--text-secondary);
  font-size: 0.8rem;
  margin-bottom: var(--spacing-sm);
}

.result-meta span:not(:last-child)::after {
  content: ' · ';
}

.result-snippet {
  font-size: 0.9rem;
  line-height: 1.6;
}

.result-snippet mark {
  background: rgba(82, 148, 196, 0.3);
  color: var(--accent-light);
  padding: 0 2px;
  border-radius: 2px;
}

.result-page {
  color: var(--text-muted);
  font-size: 0.75rem;
  margin-top: var(--spacing-sm);
}

/* Tabs */
.tabs {
  display: flex;
  border-bottom: 1px solid var(--border-color);
  margin-bottom: var(--spacing-lg);
}

.tab {
  flex: 1;
  padding: var(--spacing-md);
  text-align: center;
  color: var(--text-secondary);
  cursor: pointer;
  transition: color 0.2s, border-color 0.2s;
  border-bottom: 2px solid transparent;
  margin-bottom: -1px;
}

.tab:hover {
  color: var(--text-primary);
}

.tab.active {
  color: var(--accent);
  border-bottom-color: var(--accent);
}

/* Book Item */
.book-item {
  background: var(--bg-card);
  border-radius: var(--radius-sm);
  padding: var(--spacing-md);
  margin-bottom: var(--spacing-sm);
}

.book-title {
  font-size: 1rem;
  margin-bottom: var(--spacing-xs);
}

.book-meta {
  color: var(--text-secondary);
  font-size: 0.8rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.book-info span:not(:last-child)::after {
  content: ' · ';
}

.book-actions {
  display: flex;
  gap: var(--spacing-sm);
}

.book-action-btn {
  background: transparent;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  padding: var(--spacing-xs);
  transition: color 0.2s;
}

.book-action-btn:hover {
  color: var(--text-primary);
}

.book-action-btn.danger:hover {
  color: var(--danger);
}

.book-action-btn svg {
  width: 18px;
  height: 18px;
}

/* Author Item */
.author-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--spacing-md);
  border-bottom: 1px solid var(--border-color);
  cursor: pointer;
  transition: background-color 0.2s;
}

.author-item:hover {
  background: var(--bg-hover);
}

.author-name {
  display: flex;
  gap: var(--spacing-sm);
}

.author-death {
  color: var(--text-secondary);
}

.author-book-count {
  color: var(--text-muted);
}

/* Category Item */
.category-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--spacing-md);
  border-bottom: 1px solid var(--border-color);
  cursor: pointer;
  transition: background-color 0.2s;
}

.category-item:hover {
  background: var(--bg-hover);
}

.category-name {
  display: flex;
  gap: var(--spacing-sm);
}

.category-number {
  color: var(--text-secondary);
}

.category-count {
  color: var(--text-muted);
}

/* Collection Item */
.collection-item {
  background: var(--bg-card);
  border-radius: var(--radius-sm);
  margin-bottom: var(--spacing-md);
  overflow: hidden;
}

.collection-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--spacing-md);
  cursor: pointer;
  transition: background-color 0.2s;
}

.collection-header:hover {
  background: var(--bg-hover);
}

.collection-title {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
}

.collection-toggle {
  color: var(--text-muted);
  transition: transform 0.2s;
}

.collection-item.expanded .collection-toggle {
  transform: rotate(180deg);
}

.collection-stats {
  display: flex;
  align-items: center;
  gap: var(--spacing-md);
}

.collection-progress {
  width: 100px;
  height: 6px;
  background: var(--bg-hover);
  border-radius: 3px;
  overflow: hidden;
}

.collection-progress-bar {
  height: 100%;
  background: var(--accent);
  transition: width 0.3s;
}

.collection-count {
  color: var(--text-muted);
  font-size: 0.85rem;
}

.collection-books {
  border-top: 1px solid var(--border-color);
  display: none;
}

.collection-item.expanded .collection-books {
  display: block;
}

.collection-book {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--spacing-sm) var(--spacing-md);
  padding-right: var(--spacing-xl);
  border-bottom: 1px solid var(--border-color);
}

.collection-book:last-child {
  border-bottom: none;
}

.collection-book-title {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
}

.collection-book-status {
  color: var(--text-muted);
  font-size: 0.8rem;
}

.collection-book-status.complete {
  color: var(--success);
}

/* Settings */
.settings-section {
  margin-bottom: var(--spacing-xl);
}

.settings-section-title {
  color: var(--text-secondary);
  font-size: 0.85rem;
  padding: var(--spacing-sm) 0;
  border-bottom: 1px solid var(--border-color);
  margin-bottom: var(--spacing-sm);
}

.settings-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--spacing-md) 0;
  border-bottom: 1px solid var(--border-color);
}

.settings-item:last-child {
  border-bottom: none;
}

.settings-item-label {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.settings-item-description {
  color: var(--text-muted);
  font-size: 0.8rem;
}

/* Toggle Switch */
.toggle {
  position: relative;
  width: 44px;
  height: 24px;
}

.toggle input {
  opacity: 0;
  width: 0;
  height: 0;
}

.toggle-slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: var(--bg-hover);
  border-radius: 24px;
  transition: 0.3s;
}

.toggle-slider::before {
  position: absolute;
  content: "";
  height: 18px;
  width: 18px;
  left: 3px;
  bottom: 3px;
  background-color: var(--text-primary);
  border-radius: 50%;
  transition: 0.3s;
}

.toggle input:checked + .toggle-slider {
  background-color: var(--accent);
}

.toggle input:checked + .toggle-slider::before {
  transform: translateX(20px);
}

/* Input Fields */
.input-field {
  width: 100%;
  background: var(--bg-input);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  padding: var(--spacing-sm) var(--spacing-md);
  color: var(--text-primary);
  font-family: inherit;
  font-size: 0.9rem;
}

.input-field:focus {
  outline: none;
  border-color: var(--accent);
}

/* Buttons */
.btn {
  background: var(--bg-card);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  padding: var(--spacing-sm) var(--spacing-md);
  color: var(--text-primary);
  font-family: inherit;
  font-size: 0.9rem;
  cursor: pointer;
  transition: background-color 0.2s, border-color 0.2s;
}

.btn:hover {
  background: var(--bg-hover);
}

.btn-primary {
  background: var(--accent);
  border-color: var(--accent);
  color: #fff;
}

.btn-primary:hover {
  background: #4a86b0;
  border-color: #4a86b0;
}

.btn-danger {
  color: var(--danger);
}

.btn-danger:hover {
  background: var(--danger);
  border-color: var(--danger);
  color: #fff;
}

/* Reader */
.reader-header {
  display: flex;
  align-items: center;
  gap: var(--spacing-md);
  padding: var(--spacing-md);
  background: var(--bg-card);
  border-bottom: 1px solid var(--border-color);
  position: sticky;
  top: 0;
  z-index: 10;
}

@media (min-width: 768px) {
  .reader-header {
    top: var(--nav-height);
  }
}

.reader-back-btn {
  background: transparent;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  padding: var(--spacing-xs);
}

.reader-back-btn:hover {
  color: var(--text-primary);
}

.reader-title {
  flex: 1;
  font-size: 1rem;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.reader-title-link {
  text-decoration: none;
  color: inherit;
  cursor: pointer;
  transition: color 0.2s;
}

.reader-title-link:hover {
  color: var(--primary);
}

.reader-content {
  max-width: 700px;
  margin: 0 auto;
  padding: var(--spacing-lg);
  font-size: 1.1rem;
  line-height: 2;
}

.reader-nav {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: var(--spacing-md);
  padding: var(--spacing-md);
  border-top: 1px solid var(--border-color);
  background: var(--bg-card);
}

.reader-nav-btn {
  background: transparent;
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  padding: var(--spacing-sm) var(--spacing-md);
  color: var(--text-primary);
  cursor: pointer;
  transition: background-color 0.2s;
}

.reader-nav-btn:hover:not(:disabled) {
  background: var(--bg-hover);
}

.reader-nav-btn:disabled {
  color: var(--text-muted);
  cursor: not-allowed;
}

.reader-page-input {
  width: 60px;
  text-align: center;
  background: var(--bg-input);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  padding: var(--spacing-sm);
  color: var(--text-primary);
  font-family: inherit;
}

.reader-page-total {
  color: var(--text-muted);
}

/* TOC Sidebar */
.reader-toc {
  position: fixed;
  top: 0;
  right: 0;
  width: 300px;
  height: 100vh;
  background: var(--bg-card);
  border-left: 1px solid var(--border-color);
  transform: translateX(100%);
  transition: transform 0.3s;
  z-index: 1001;
  overflow-y: auto;
}

.reader-toc.open {
  transform: translateX(0);
}

.reader-toc-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--spacing-md);
  border-bottom: 1px solid var(--border-color);
}

.reader-toc-close {
  background: transparent;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  padding: var(--spacing-xs);
}

.reader-toc-items {
  padding: var(--spacing-md);
}

.reader-toc-item {
  padding: var(--spacing-sm) 0;
  color: var(--text-secondary);
  cursor: pointer;
  transition: color 0.2s;
}

.reader-toc-item:hover {
  color: var(--text-primary);
}

.reader-toc-item.active {
  color: var(--accent);
}

/* Wizard */
.wizard {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: var(--spacing-xl);
  text-align: center;
}

.wizard-logo {
  font-size: 3rem;
  margin-bottom: var(--spacing-lg);
}

.wizard-title {
  font-size: 1.5rem;
  margin-bottom: var(--spacing-md);
}

.wizard-description {
  color: var(--text-secondary);
  margin-bottom: var(--spacing-xl);
  max-width: 400px;
}

.wizard-actions {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-md);
  width: 100%;
  max-width: 300px;
}

/* Empty State */
.empty-state {
  text-align: center;
  padding: var(--spacing-xl);
  color: var(--text-secondary);
}

.empty-state-icon {
  font-size: 3rem;
  margin-bottom: var(--spacing-md);
  opacity: 0.5;
}

.empty-state-text {
  margin-bottom: var(--spacing-md);
}

/* Loading State */
.loading {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--spacing-xl);
}

.loading-spinner {
  width: 32px;
  height: 32px;
  border: 3px solid var(--border-color);
  border-top-color: var(--accent);
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

/* Scrollbar Styling */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: var(--bg-color);
}

::-webkit-scrollbar-thumb {
  background: var(--border-color);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--text-muted);
}

/* Overlay */
.overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  z-index: 999;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s, visibility 0.3s;
}

.overlay.active {
  opacity: 1;
  visibility: visible;
}

/* Badge for owned books */
.badge-owned {
  background: var(--success);
  color: #fff;
  font-size: 0.65rem;
  padding: 1px 6px;
  border-radius: 10px;
  margin-right: var(--spacing-sm);
}

/* =============================================
   TURATH-STYLE READER LAYOUT
   ============================================= */

/* Continuous Scroll Container */
.reader-scroll-container {
  height: calc(100vh - 120px);
  overflow-y: auto;
  overflow-x: hidden;
  scroll-behavior: smooth;
  padding-bottom: 60px;
}

@media (min-width: 768px) {
  .reader-scroll-container {
    height: calc(100vh - 160px);
  }
}

/* Page Block - centered with max width for readability */
.reader-page-block {
  max-width: 800px;
  margin: 0 auto;
  padding: 0 24px;
}

/* Page Content */
.reader-page-content {
  font-size: 1.1rem;
  line-height: 1.9;
  padding: var(--spacing-lg) 0;
}

.reader-page-content p {
  margin-bottom: var(--spacing-md);
  text-align: justify;
}

/* Page Divider - single centered line with text overlay */
.page-divider {
  text-align: center;
  padding: 16px 0;
  margin: 20px 0;
  position: relative;
  color: var(--text-muted);
  font-size: 0.9em;
  user-select: none;
}

/* Single centered line */
.page-divider::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 0;
  right: 0;
  height: 1px;
  background: var(--border-color);
  transform: translateY(-50%);
}

/* Page number text with background to "break" the line */
.page-divider-text {
  position: relative;
  z-index: 1;
  background: var(--bg-color);
  padding: 0 12px;
  font-family: 'Amiri', serif;
  letter-spacing: 2px;
}

/* Floating Chapter Header - sticks to top of scroll container */
.floating-chapter-header {
  position: sticky;
  top: 0;
  z-index: 10;
  background: var(--bg-color);
  padding: 10px 16px;
  text-align: center;
  font-size: 0.85rem;
  color: var(--accent-light);
  border-bottom: 1px solid var(--border-color);
  font-weight: bold;
  margin: 0;
  /* Ensure it sticks properly */
  left: 0;
  right: 0;
}

/* Truncate long chapter names */
.floating-chapter-header span {
  display: block;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  max-width: 100%;
}

/* Progress Slider Bar - Default for standalone reader */
.reader-progress-bar {
  background: var(--bg-card);
  border-top: 1px solid var(--border-color);
  padding: var(--spacing-sm) var(--spacing-md);
  z-index: 100;
}

@media (min-width: 768px) {
  .reader-progress-bar {
    bottom: 0;
  }
}

.progress-slider-container {
  display: flex;
  align-items: center;
  gap: var(--spacing-md);
  max-width: 600px;
  margin: 0 auto;
}

.progress-page-label,
.progress-total-label {
  font-size: 0.85rem;
  color: var(--text-secondary);
  min-width: 40px;
  text-align: center;
  font-family: 'Amiri', serif;
}

.progress-slider {
  flex: 1;
  height: 6px;
  -webkit-appearance: none;
  appearance: none;
  background: var(--bg-hover);
  border-radius: 3px;
  cursor: pointer;
  direction: rtl;
}

.progress-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 18px;
  height: 18px;
  background: var(--accent);
  border-radius: 50%;
  cursor: pointer;
  transition: transform 0.2s;
}

.progress-slider::-webkit-slider-thumb:hover {
  transform: scale(1.2);
}

.progress-slider::-moz-range-thumb {
  width: 18px;
  height: 18px;
  background: var(--accent);
  border-radius: 50%;
  border: none;
  cursor: pointer;
}

/* Load More Indicator */
.load-more-indicator {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-sm);
  padding: var(--spacing-lg);
  color: var(--text-muted);
  font-size: 0.9rem;
}

/* End of Book */
.end-of-book {
  text-align: center;
  padding: var(--spacing-xl);
  color: var(--text-muted);
  font-size: 0.9rem;
  border-top: 1px solid var(--border-color);
  margin: var(--spacing-xl) auto;
  max-width: 300px;
}

/* Hadith Number */
.hadith-number {
  display: inline;
  font-size: 0.85em;
  color: var(--accent);
  padding: 0 2px;
  user-select: none;
  font-family: 'Amiri', serif;
}

/* Goto Page Modal */
.goto-modal {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: var(--bg-card);
  padding: var(--spacing-lg);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-popover);
  z-index: 1100;
}

.goto-modal-content {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-md);
  min-width: 200px;
}

.goto-modal-content label {
  font-size: 0.9rem;
  color: var(--text-secondary);
}

.goto-modal-content input {
  background: var(--bg-input);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  padding: var(--spacing-sm);
  color: var(--text-primary);
  font-family: inherit;
  font-size: 1rem;
  text-align: center;
}

/* Keyboard Help - Turath style */
.keyboard-help {
  position: fixed;
  bottom: 120px;
  left: 50%;
  transform: translateX(-50%);
  background: var(--bg-card);
  padding: var(--spacing-lg);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-popover);
  z-index: 1000;
  min-width: 280px;
}

/* =============================================
   TURATH-STYLE TOC SIDEBAR
   ============================================= */

.turath-toc {
  display: flex;
  flex-direction: column;
}

/* TOC Tabs */
.toc-tabs {
  display: flex;
  border-bottom: 1px solid var(--border-color);
  background: var(--bg-color);
}

.toc-tab {
  flex: 1;
  padding: var(--spacing-sm) var(--spacing-xs);
  background: transparent;
  border: none;
  color: var(--text-secondary);
  font-size: 0.75rem;
  cursor: pointer;
  transition: color 0.2s, background-color 0.2s;
  text-align: center;
}

.toc-tab:hover {
  color: var(--text-primary);
  background: var(--bg-hover);
}

.toc-tab.active {
  color: var(--accent);
  border-bottom: 2px solid var(--accent);
  margin-bottom: -1px;
}

/* TOC Panel */
.toc-panel {
  flex: 1;
  overflow-y: auto;
  padding: var(--spacing-md);
}

/* TOC Tree */
.toc-tree-item {
  margin-bottom: var(--spacing-xs);
}

.toc-item-header {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  padding: var(--spacing-sm);
  cursor: pointer;
  border-radius: var(--radius-sm);
  transition: background-color 0.2s;
}

.toc-item-header:hover {
  background: var(--bg-hover);
}

.toc-tree-item.active > .toc-item-header {
  background: rgba(82, 148, 196, 0.15);
  color: var(--accent);
}

.toc-item-toggle {
  display: flex;
  align-items: center;
  color: var(--text-muted);
  transition: transform 0.2s;
}

.toc-item-toggle svg.rotated {
  transform: rotate(90deg);
}

.toc-item-title {
  flex: 1;
  font-size: 0.9rem;
}

.toc-item-ref {
  font-size: 0.75rem;
  color: var(--text-muted);
  font-family: 'Amiri', serif;
}

/* TOC Children */
.toc-children {
  padding-right: var(--spacing-lg);
  margin-top: var(--spacing-xs);
}

.toc-tree-item.child {
  padding: var(--spacing-xs) var(--spacing-sm);
  cursor: pointer;
  display: flex;
  justify-content: space-between;
  font-size: 0.85rem;
  border-radius: var(--radius-sm);
}

.toc-tree-item.child:hover {
  background: var(--bg-hover);
}

.toc-tree-item.child.active {
  color: var(--accent);
}

/* TOC Search */
.toc-search-input {
  display: flex;
  gap: var(--spacing-sm);
  margin-bottom: var(--spacing-md);
}

.toc-search-input input {
  flex: 1;
  background: var(--bg-input);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  padding: var(--spacing-sm);
  color: var(--text-primary);
  font-family: inherit;
  font-size: 0.9rem;
}

.toc-search-input input:focus {
  outline: none;
  border-color: var(--accent);
}

.toc-search-input button {
  background: var(--accent);
  border: none;
  border-radius: var(--radius-sm);
  padding: var(--spacing-sm);
  color: white;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Search Results */
.toc-search-results {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-sm);
}

.search-result-item {
  padding: var(--spacing-sm);
  background: var(--bg-hover);
  border-radius: var(--radius-sm);
  cursor: pointer;
  transition: background-color 0.2s;
}

.search-result-item:hover {
  background: rgba(82, 148, 196, 0.15);
}

.search-result-text {
  font-size: 0.85rem;
  margin-bottom: var(--spacing-xs);
  overflow: hidden;
  text-overflow: ellipsis;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
}

.search-result-page {
  font-size: 0.75rem;
  color: var(--text-muted);
}

/* Favorites */
.favorite-item {
  display: flex;
  align-items: flex-start;
  gap: var(--spacing-sm);
  padding: var(--spacing-sm);
  border-bottom: 1px solid var(--border-color);
}

.favorite-content {
  flex: 1;
  cursor: pointer;
}

.favorite-content:hover {
  color: var(--accent);
}

.favorite-excerpt {
  font-size: 0.85rem;
  margin-bottom: var(--spacing-xs);
  overflow: hidden;
  text-overflow: ellipsis;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
}

.favorite-page {
  font-size: 0.75rem;
  color: var(--text-muted);
}

.favorite-delete {
  background: transparent;
  border: none;
  color: var(--text-muted);
  cursor: pointer;
  padding: var(--spacing-xs);
}

.favorite-delete:hover {
  color: var(--danger);
}

/* History */
.history-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--spacing-sm);
  border-bottom: 1px solid var(--border-color);
  cursor: pointer;
  transition: background-color 0.2s;
}

.history-item:hover {
  background: var(--bg-hover);
}

.history-page {
  font-size: 0.9rem;
}

.history-time {
  font-size: 0.75rem;
  color: var(--text-muted);
}

/* =============================================
   SIDEBAR LAYOUT - Right-side pinnable sidebar
   Full-height with independent scrolling
   ============================================= */

/* Remove body and page-content padding when reader is present */
html:has(.book-reader-container),
body:has(.book-reader-container) {
  overflow: hidden;
  height: 100vh;
}

body:has(.book-reader-container) {
  padding-top: 0;
  padding-bottom: 0;
}

.page-content:has(.book-reader-container) {
  padding: 0;
}

/* Notebook page - lock scrolling to panels */
html:has(.notebook-container),
body:has(.notebook-container) {
  height: 100%;
  overflow: hidden;
  margin: 0;
  padding: 0;
}

.page-content:has(.notebook-container) {
  padding: 0;
  height: calc(100vh - var(--nav-height, 70px)); /* Subtract navbar height! */
  margin-top: var(--nav-height); /* Push below fixed navbar */
  overflow: hidden;
}

/* Main Reader Container */
.book-reader-container {
  display: flex;
  flex-direction: column;
  height: calc(100vh - var(--nav-height));
  margin-top: var(--nav-height);
  background: var(--bg-color);
  overflow: hidden;
}

/* Reader Header - Fixed height */
.book-reader-container .reader-header {
  flex-shrink: 0;
  position: relative;
  top: auto;
  z-index: 10;
}

/* Reader Main Layout - Side-by-side flexbox */
.reader-main-layout {
  display: flex;
  flex-direction: row-reverse; /* RTL: sidebar on right */
  flex: 1;
  min-height: 0; /* Allow flex child to shrink */
  overflow: hidden;
  position: relative;
}

/* Book Content Area - scrolls independently */
.book-content-area {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  min-width: 0;
  min-height: 0; /* Allow flex child to shrink */
  position: relative;
}

/* TOC Sidebar - full height with independent scroll */
.toc-sidebar {
  width: var(--sidebar-width);
  min-width: 280px;
  max-width: 380px;
  flex-shrink: 0;
  background: var(--bg-card);
  border-right: 1px solid var(--border-color);
  display: flex;
  flex-direction: column;
  transition: width 0.3s ease, transform 0.3s ease;
  overflow: hidden;
}

.toc-sidebar.collapsed {
  width: 0;
  border-right: none;
}

/* Sidebar Header - sticky at top of sidebar */
.sidebar-header {
  flex-shrink: 0;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--spacing-sm) var(--spacing-md);
  border-bottom: 1px solid var(--border-color);
  background: var(--bg-color);
  min-height: 48px;
}

.sidebar-title {
  font-size: 0.9rem;
  color: var(--text-primary);
  font-weight: 500;
}

/* Pin Toggle Button */
.pin-toggle {
  background: transparent;
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  padding: var(--spacing-xs) var(--spacing-sm);
  color: var(--text-secondary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: var(--spacing-xs);
  font-size: 0.75rem;
  transition: all 0.2s ease;
}

.pin-toggle:hover {
  background: var(--bg-hover);
  color: var(--text-primary);
  border-color: var(--accent);
}

.pin-toggle.pinned {
  background: rgba(82, 148, 196, 0.15);
  border-color: var(--accent);
  color: var(--accent);
}

.pin-toggle svg {
  width: 14px;
  height: 14px;
}

/* TOC Tabs - sticky below header */
.toc-sidebar .toc-tabs {
  flex-shrink: 0;
  background: var(--bg-color);
}

/* Scrollable Content Wrapper */
.sidebar-content {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  min-height: 0; /* Required for flex child scrolling */
}

/* TOC Panel - inside scrollable area */
.toc-sidebar .toc-panel {
  padding: var(--spacing-md);
}

/* Sidebar Footer - fixed at bottom */
.sidebar-footer {
  flex-shrink: 0;
  padding: var(--spacing-sm) var(--spacing-md);
  border-top: 1px solid var(--border-color);
  background: var(--bg-color);
}

/* Sidebar Expand Tab (when collapsed) */
.sidebar-expand-tab {
  position: fixed;
  top: 50%;
  right: 0;
  transform: translateY(-50%);
  background: var(--bg-card);
  border: 1px solid var(--border-color);
  border-right: none;
  border-radius: var(--radius-sm) 0 0 var(--radius-sm);
  padding: var(--spacing-md) var(--spacing-sm);
  color: var(--text-secondary);
  cursor: pointer;
  display: none;
  flex-direction: column;
  align-items: center;
  gap: var(--spacing-xs);
  font-size: 0.7rem;
  transition: all 0.2s ease;
  z-index: 100;
}

.sidebar-expand-tab:hover {
  background: var(--bg-hover);
  color: var(--accent);
  padding-right: var(--spacing-md);
}

.sidebar-expand-tab svg {
  width: 20px;
  height: 20px;
}

/* Show expand tab when sidebar is collapsed */
.toc-sidebar.collapsed ~ .sidebar-expand-tab {
  display: flex;
}

/* Progress bar - within flex content area */
.book-content-area .reader-progress-bar {
  flex-shrink: 0;
  position: relative;
  bottom: auto;
  z-index: 10;
}

/* Floating chapter header within scroll container - ensure sticky works */
.reader-scroll-container .floating-chapter-header {
  position: sticky;
  top: 0;
  z-index: 10;
  background: var(--bg-color);
}

/* Ensure reader scroll container fills available space */
.book-content-area .reader-scroll-container {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  min-height: 0;
  padding-bottom: var(--progress-bar-height);
  scroll-behavior: smooth;
}

/* Prevent content overflow */
.reader-page-content {
  word-wrap: break-word;
  overflow-wrap: break-word;
}

/* Tablet - Sidebar becomes overlay */
@media (max-width: 1024px) {
  .reader-main-layout {
    position: relative;
  }

  .toc-sidebar {
    position: fixed;
    top: var(--nav-height);
    right: 0;
    bottom: 0;
    height: auto;
    z-index: 1001;
    border-right: none;
    border-left: 1px solid var(--border-color);
    box-shadow: -4px 0 20px rgba(0, 0, 0, 0.3);
    transform: translateX(0);
    transition: transform 0.3s ease;
    background: var(--bg-color);
  }

  .toc-sidebar.collapsed {
    transform: translateX(100%);
    width: var(--sidebar-width);
  }

  .sidebar-expand-tab {
    display: flex;
  }

  .toc-sidebar.collapsed ~ .sidebar-expand-tab {
    display: flex;
  }

  .book-content-area {
    width: 100%;
  }
}

/* Mobile */
@media (max-width: 768px) {
  :root {
    --nav-height: 60px;
    --content-padding: 16px;
  }

  .reader-page-block {
    padding: 12px 16px;
  }

  .reader-page-content {
    font-size: 1rem;
    line-height: 1.8;
  }

  .floating-chapter-header {
    font-size: 0.85rem;
    padding: 10px 12px;
  }

  .page-divider {
    margin: 12px 0;
    padding: 12px 0;
  }
}

/* Small mobile */
@media (max-width: 480px) {
  .floating-chapter-header span {
    display: block;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
}

/* =============================================
   AI CHAT COLUMN - Collapsible column layout
   ============================================= */

/* AI Chat Column - positioned to right of TOC */
.ai-chat-column {
  width: 350px;
  min-width: 280px;
  max-width: 450px;
  height: 100%;
  background: var(--bg-card);
  border-right: 1px solid var(--border-color);
  display: flex;
  flex-direction: column;
  transition: width 0.3s ease;
  overflow: hidden;
  flex-shrink: 0;
}

/* Expanded state */
.ai-chat-column:not(.collapsed) {
  width: 350px;
}

/* Collapsed state */
.ai-chat-column.collapsed {
  width: 48px;
  min-width: 48px;
  cursor: pointer;
}

.ai-chat-column.collapsed:hover {
  background: var(--bg-hover);
}

/* Collapsed indicator */
.ai-column-collapsed {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  gap: var(--spacing-md);
  color: var(--text-secondary);
  padding: var(--spacing-md);
}

.ai-column-label {
  writing-mode: vertical-rl;
  text-orientation: mixed;
  font-size: 0.85rem;
  font-weight: 500;
  letter-spacing: 1px;
}

/* Expanded content wrapper */
.ai-column-content {
  display: flex;
  flex-direction: column;
  height: 100%;
  overflow: hidden;
}

/* AI Column Header */
.ai-column-header {
  flex-shrink: 0;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--spacing-sm) var(--spacing-md);
  border-bottom: 1px solid var(--border-color);
  background: var(--bg-color);
  min-height: 48px;
  font-size: 0.9rem;
  font-weight: 500;
}

.ai-collapse-btn {
  background: transparent;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  padding: var(--spacing-xs);
  border-radius: var(--radius-sm);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
}

.ai-collapse-btn:hover {
  background: var(--bg-hover);
  color: var(--text-primary);
}

/* Chat Messages Area */
.ai-messages {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 16px;
  min-height: 0;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

/* Individual message */
.ai-message {
  display: flex;
  width: 100%;
}

.ai-message.user {
  justify-content: flex-end;
}

.ai-message.assistant {
  justify-content: flex-start;
}

.ai-message-bubble {
  max-width: 85%;
  min-width: 60px;
  padding: 10px 14px;
  border-radius: 12px;
  word-break: break-word;
  overflow-wrap: break-word;
  unicode-bidi: plaintext;
  line-height: 1.5;
}

.ai-message.user .ai-message-bubble {
  background: rgb(82, 148, 196);
  color: white;
  border-bottom-right-radius: 4px;
}

.ai-message.assistant .ai-message-bubble {
  background: var(--bg-hover);
  color: var(--text-primary);
  border-bottom-left-radius: 4px;
}

/* Loading state */
.ai-loading {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-sm);
  color: var(--text-muted);
  font-size: 0.8rem;
  padding: var(--spacing-md);
}

/* Empty state */
.ai-empty {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  gap: var(--spacing-md);
  color: var(--text-muted);
  font-size: 0.85rem;
  text-align: center;
  padding: var(--spacing-lg);
}

/* Input Area - Fixed at bottom */
.ai-input-area {
  flex-shrink: 0;
  display: flex;
  gap: var(--spacing-sm);
  padding: 12px 16px;
  border-top: 1px solid var(--border-color);
  background: var(--bg-card);
}

.ai-input {
  flex: 1;
  width: 100%;
  padding: 10px 12px;
  border-radius: 8px;
  border: 1px solid var(--border-color);
  background: var(--bg-input);
  color: var(--text-primary);
  font-family: inherit;
  font-size: 0.85rem;
  direction: rtl;
}

.ai-input:focus {
  outline: none;
  border-color: var(--accent);
}

.ai-send-btn {
  background: var(--accent);
  border: none;
  border-radius: var(--radius-sm);
  padding: var(--spacing-sm);
  color: white;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background-color 0.2s ease;
}

.ai-send-btn:hover {
  background: #4a86b0;
}

/* AI Toggle Button in Header */
.ai-toggle-btn.active {
  color: var(--accent);
  background: rgba(82, 148, 196, 0.15);
}

/* AI Chat specific font sizing - independent of root */
.ai-chat-sidebar,
.ai-chat-column,
.ai-chat-column * {
  font-size: 16px;
}

.ai-message-bubble {
  font-size: 15px;
  line-height: 1.5;
}

.ai-column-header {
  font-size: 14px;
  font-weight: 600;
}

.ai-input,
.ai-input::placeholder {
  font-size: 14px;
}

.ai-loading,
.ai-empty {
  font-size: 13px;
}

/* AI Model Switcher */
.ai-header-title {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
}

.ai-model-switcher {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 3px 8px;
  background: var(--bg-hover);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  color: var(--text-secondary);
  font-size: 12px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.ai-model-switcher:hover {
  background: var(--bg-input);
  color: var(--text-primary);
  border-color: var(--accent);
}

.ai-model-name {
  max-width: 80px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.ai-model-chevron {
  width: 12px;
  height: 12px;
  transition: transform 0.2s ease;
}

.ai-model-chevron.rotated {
  transform: rotate(180deg);
}

.ai-model-dropdown {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  margin-top: 4px;
  background: var(--bg-card);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-md);
  box-shadow: var(--shadow-popover);
  z-index: 100;
  overflow: hidden;
}

.ai-model-option {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
  padding: var(--spacing-sm) var(--spacing-md);
  background: none;
  border: none;
  color: var(--text-primary);
  font-size: 13px;
  text-align: right;
  cursor: pointer;
  transition: background-color 0.15s ease;
}

.ai-model-option:hover {
  background: var(--bg-hover);
}

.ai-model-option.active {
  background: rgba(82, 148, 196, 0.15);
  color: var(--accent);
}

.ai-model-option svg {
  color: var(--accent);
}

/* AI Header Button (Save chat, etc.) */
.ai-header-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 4px;
  background: none;
  border: none;
  border-radius: var(--radius-sm);
  color: var(--text-muted);
  cursor: pointer;
  transition: all 0.15s ease;
}

.ai-header-btn:hover {
  background: var(--bg-hover);
  color: var(--text-primary);
}

/* Mobile: Slide-in AI panel */
@media (max-width: 900px) {
  .ai-chat-column {
    position: fixed;
    right: 0;
    top: 70px;
    bottom: 0;
    width: 100%;
    max-width: 400px;
    z-index: 1000;
    transform: translateX(100%);
    transition: transform 0.3s ease;
  }

  .ai-chat-column:not(.collapsed) {
    transform: translateX(0);
    width: 100%;
  }

  .ai-chat-column.collapsed {
    display: none;
  }
}

/* ============================================
   Text Selection Menu
   ============================================ */

.selection-menu {
  position: fixed;
  z-index: 1100;
  display: flex;
  gap: 2px;
  background: var(--bg-card);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-md);
  box-shadow: var(--shadow-popover);
  padding: 4px;
  animation: fadeIn 0.15s ease;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(5px); }
  to { opacity: 1; transform: translateY(0); }
}

.selection-menu-btn {
  display: flex;
  align-items: center;
  gap: var(--spacing-xs);
  padding: 8px 12px;
  background: none;
  border: none;
  border-radius: var(--radius-sm);
  color: var(--text-primary);
  font-size: 13px;
  cursor: pointer;
  white-space: nowrap;
  transition: background-color 0.15s ease;
}

.selection-menu-btn:hover {
  background: var(--bg-hover);
}

.selection-menu-btn svg {
  flex-shrink: 0;
}

/* Toast Notification */
.toast {
  position: fixed;
  bottom: 100px;
  left: 50%;
  transform: translateX(-50%);
  background: var(--bg-card);
  color: var(--text-primary);
  padding: 12px 24px;
  border-radius: var(--radius-md);
  box-shadow: var(--shadow-popover);
  z-index: 1200;
  font-size: 14px;
}

/* Mobile: Stack selection menu buttons */
@media (max-width: 600px) {
  .selection-menu {
    flex-direction: column;
    min-width: 160px;
  }

  .selection-menu-btn {
    justify-content: flex-start;
  }
}

/* =============================================
   TOUCH SCROLL FIX - Two-finger trackpad scroll
============================================= */

/* Fix for scrollable containers */
.reader-scroll-container,
.sidebar-content,
.toc-panel,
.ai-messages,
.popover,
.note-editor-textarea {
  -webkit-overflow-scrolling: touch;
  touch-action: pan-y;
}

/* Allow both horizontal and vertical panning on body/html when needed */
html, body {
  touch-action: pan-x pan-y;
}

/* Notebook-specific scrollable areas */
.notebook-sidebar .sidebar-content {
  -webkit-overflow-scrolling: touch;
  touch-action: pan-y;
}
